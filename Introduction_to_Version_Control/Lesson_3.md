# **Урок 3. Первое использование контроля версий**

## **Создание репозитория в Git**

- **git init** (*initialization*) - создание из папки репозитория.

## **Запись изменений в репозитории**

- ### **Проверка состояния файлов**

    - **git status** -s - определяет состояние файлов.  
      **-s** (*short*) упрощенный вариант вывода информации.

- ### **Слежение за новыми файлами (индексация)**

    - **git add** <имя файла> - добавление файла или папки в git для отслеживания его изменений.  
      Содержимое файла должно быть перед этим сохранено. Содержимое папки также будет отслеживаться. TAB - автозаполнение названий файлов.

- ### **Игнорирование файлов**

    - **.gitignore** - файл исключений. Вносим в него названия тяжелых файлов прикрепленных к документам, но незакоммиченных и git на них больше не ругается.

- ### **Просмотр индексированных и неиндексированных изменений**

    - **git diff** (*difference*) - показывает разницу между сохраненным коммитом и текущим файлом.

- ### **Фиксация изменений**

    - **git commit** -am "Комментарий" - фиксация изменений.  
      **-m** "Комментарий" - (*message*) оставить комментарий к изменению. Самый первый коммит принято называть "Initial commit".  
      **-a** (*all*) коммиты без *git add*. Не работает с не отслеживаемыми файлами.  
      git commit **<имя файла>** - закоммичен будет только этот файл, даже если будут другие.

- ### **Удаление файлов**

    - **git rm** <имя файла> - (*remove*) удаление файла из числа отслеживаемых Git.

- ### **Перемещение файлов**

    - **git mv** <имя файла> <папка/имя файла>  
      Самой команды на перемещение файла нет, но через переименование можно прописать новый путь до него, тем самым переместив. Все коммиты "переименованного" файла сохранятся, а файл будет считаться в системе удаленным.

## **Просмотр истории версий**

- **git log** - журнал изменений. История коммита. Будущие коммиты отображены не будут.  
  **-p** - показывает разницу внесенную каждым коммитом.  
  **-2** - ограничивает выводимый результат двумя последними коммитами.  
  **--graph** - отображение списка коммитов в виде красивого дерева.  
  **--pretty** - меняет формат вывода информации. Пример: *--pretty=format:"%h - %an, %ar : %s"*

## **Отмена изменений (опасно)**

- git commit **--amend** - перезапись последнего коммита с внесением новых изменений.

- ### **Отмена индексирования (безопасно)**

    - **git reset** HEAD <имя файла> - если случайно прописали *git add* файлу который не хотели коммитить.

- ### **Отмена внесенных в файл изменений (опасно)**

    - **git checkout** -- <имя файла> - возвращение не закоммиченного файла в исходное состояние.

## **Удаленные репозитории (на сервере)**

- ### **Отображение удаленных репозиториев**

    - **git remote** - просмотр уже настроенных удаленных серверов.  
      **-v** - показывает URL-адрес удаленных репозиториев.

- ### **Добавление удаленных репозиториев**

    - **git remote add** <сокращенное имя> \<URL> - добавление удаленного репозитория.  
      **git fetch** <сокращенное имя> - обращение к уже известному удаленному репозиторию по сокращенному имени и скачивание его. Важно, *git fetch* скачивает данные из удаленного репозитория, но не производит слияние с вашей веткой.

- ### **Извлечение данных из удаленных репозиториев**

    - **git pull** - если имеется ветка, настроенная на слежение за какой-то удаленной веткой, эта команда будет автоматически извлекать информацию из удаленной ветки и выполнять слияние с текущей.

- ### **Отправка данных в удаленный репозиторий**

    - **git push** <имя удаленного сервера> <ветка> - отправка данных своей ветки на удаленный репозиторий. Перед этим необходимо скачать последние обновления с сервера и слить со своей веткой.

- ### **Просмотр удаленных репозиториев**

    - **git remote show** <имя удаленного сервера> - получение дополнительной информации о конкретном удаленном репозитории. Пример: *git remote show origin*.

- ### **Удаление и переименование удаленных репозиториев**

    - **git remote rename** <имя было> <имя стало> - переименование ссылки на сокращенное имя удаленного репозитория. Имя удаленной ветки тоже поменялось.
    - git remote rm <имя ссылки> - удаление ссылки на удаленный репозиторий.

## **Теги**

Как правило, теги используют для пометки выходящих версий (v1.0 и т.п).

- ### **Вывод списка тегов**

    - **git tag** - выводит список тегов.

- ### **Создание тегов**

    - **git tag -a** v1.4 **-m** "my version 1.4" - тег с комментарием. Хранится в базе данных Git как полноценный объект. Виден посредством *git show*.
    - git tag v1.4 - легковесный тег - указатель на конкретный коммит. Не виден посредством *git show*.

- ### **Расстановка тегов постфактум**

    - git tag -a v1.2  <хеш коммита>

- ### **Обмен тегами**

  Созданные вами теги нужно отправлять на сервер общего доступа отдельно.

    - git push origin <имя тега> - отправляет на удаленный сервер только один конкретный тег.  
      **--tags** - отправит на удаленный сервер все теги, которых там пока нет.

---

## **Работа с ветками**

Ветка master - чистовик, остальные - черновики.  
Указатель HEAD - показывает на локальную ветку, в которой мы находимся в данный момент.

**git branch** - просмотр списка существующих веток.  
**--merged** / **--no-merged** - оставить только те ветки, которые слиты с текущей веткой или не слиты.

**git status** позволяет просмотреть текущее состояние, в том числе название текущей ветки.

- ### **Добавление новой ветки**

    - **git branch** <имя ветки> - создали новую ветку, но не перешли в нее.

- ### **Переход между ветками**

    - **git checkout** <имя ветки> - переход между ветками.  
      **-b** - (*branch*) создаем и переходим в ветку.  
      *git checkout master* - возвращение к главной ветви.

- ### **Слияние веток**

    - **git merge** <имя ветки> - сливаем ветку <имя ветки> с текущей веткой.

- ### **Удаление веток**

    - git branch **-d** <имя ветки> - (*delete*) удаление ветки. Коммиты при удалении остаются в ветке с которой эту ветку прежде объединяли.

## **Последствия слияния веток**

Бывают случаи, когда сливаемые ветки конфликтуют друг с другом. Когда в основной ветке есть противоречие относительно изменений получаемых из побочной ветки. В таких случаях в среде VS Code нам предоставляется возможность реализовать один из следующих вариантов:

**Accept Current Change** - принять текущее изменение. Оставить в основной ветке ее версию данных.  
**Accept Incoming Change** - принять входящее изменение. Заменить данные основной ветки на данные вливаемой ветки.  
**Accept Both Changes** - принять оба изменения. Оставить оба варианта для возможности вручную указать итоговые данные.  
**Compare Changes** - сравнить изменения.

Указатель HEAD показывает содержимое ветки в которую вливают - master, и находится в верхней части. А содержимое ветки, которую вливают, в нижней. После устранения конфликта изменения индексируют - git add и фиксируют - git commit.

---

## **Дополнительный материал**

[Learn Git Branching.](<https://learngitbranching.js.org/?locale=ru_RU>)

---
[Вернуться назад](<Introduction_to_Version_Control.md>)