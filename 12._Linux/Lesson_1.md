# **Установка системы**

### **Операционные системы**

Операционная система это прослойка между приложением и железом, на котором оно работает. Она реализует работу сети, управление ресурсами компьютера, 
файловые системы и другие низкоуровневые элементы. Такая архитектура резко упрощает разработку приложений.

1970 - появление UNIX систем.  
В первых компьютерах программисты были вынуждены управлять железом напрямую, например, вызывать низкоуровневые инструкции процессора и управлять
накопителями информации напрямую. Программы в этом случае содержали машинные коды (инструкции), никаких языков программирования не существовало.

### **Ядро, библиотеки, приложения**

Любую современную операционную систему можно условно разделить на несколько уровней.
   
Прежде всего, ОС характеризуется ядром (*kernel*). Это низкоуровневый
компонент, который отвечает за взаимодействие с железом. Также ядро предоставляет интерфейс для более высокоуровневых компонентов (библиотек и
приложений). Этот интерфейс обычно реализуется в виде набора системных вызовов (*system calls*).
   
Библиотеки (*libraries*) представляют собой набор общих функций, которые часто используются в приложениях. Например, это может быть библиотека, реализующая
алгоритм сжатия zip или работу какого-либо алгоритма шифрования для работы с HTTPS-сайтами. За счет использования библиотек разработчики могут быстро
подключать новые возможности и технологии в свой продукт. Библиотеки - набор часто используемых функций, написанных один раз и используемых везде где надо.
   
Приложения (*applications*) – верхний уровень этой архитектуры. То, ради чего построены все нижние уровни. Приложение может быть пользовательским
(текстовый редактор, браузер, калькулятор) или серверным (веб-сервер, почтовый сервер, сервер баз данных). Часть приложений могут входить в состав операционной
системы, остальные устанавливаются дополнительно. Важно отметить, что совместимость операционной системы с нужными приложениями является важным
фактором выбора ОС под конкретную задачу.

### **Системные вызовы в Linux**

Посмотрим, какие задачи могут решать системные вызовы в ОС Linux. Все системные вызовы делятся на группы, например управление процессами, управление файлами, работа с памятью и т.д.
   
Например, чтобы создать новый процесс, вызывается fork() – он создаёт полную копию исходного процесса и может продолжать выполнение программы или
запустить новую через вызов exec(). Завершить программу можно вызовом exit(). Также происходит с файлами: открыть через open(), прочитать с помощью read(),
записать через write() и закрыть – close().
   
При использовании системных вызовов разработчику не нужно знать подробностей реализации каждого вызова, например, на какой файловой системе находится файл,
как расположены блоки на диске и какой он имеет объём.
   
Приложения --(системные вызовы)--> библиотеки ---> ядро ---> железо.

### **Серверные и настольные системы**

Формально мы можем разделить ОС на серверные (*server*) и настольные (*desktop*).
      
**Серверные системы** нацелены на поддержку работы серверных приложений. Они должны обеспечивать повышенную стабильность и иметь высокий уровень
безопасности. Должны поддерживать серверное железо. Такие системы большую часть времени работают без взаимодействия с пользователем в автоматическом
режиме выполняют серверные приложения. Поэтому часто они не имеют графического интерфейса, что повышает их эффективность и надёжность. Если
необходимо взаимодействие с системой оно обычно осуществляется удалённо с помощью текстового интерфейса.
      
**Настольные системы** предлагают широкую совместимость с пользовательским ПО. Имеют графический интерфейс и, как правило, используются локально, без
удалённого управления. Должны поддерживать потребительское железо. Главное – удобство и совместимость, надёжность и стабильность вторичны.
При этом часто серверные и настольные системы используют одно и то же ядро (за исключением искусственных ограничений) и отличаются набором библиотек,
драйверов, средств управления и уровнем тестирования компонентов. Например, ядро Linux универсально и поддерживает любые применения.

### **Предшественники – UNIX-системы**

Предками Linux являются UNIX-системы. Это семейство ОС, объединенных общими принципами работы и подходами к функциональности. В большинстве своём это
были коммерческие ОС, разработанные крупными корпорациями для работы на железе их собственной разработки.

Принципы UNIX, специализация команд: одна маленькая команда должна выполнять только одну задачу, но хорошо. Конвеер команд - много команд.

Коммерческая лицензия сильно ограничивала использование ОС как в учебных целях, так и в бизнесе. Поэтому были разработаны открытые операционные системы
(*open source*), например FreeBSD. Такие системы можно было свободно распространять и вносить изменения через сообщества.
Потребность в совместимости различных UNIX-систем породила стандарт POSIX(*Portable Operating System Interface* — переносимый интерфейс операционных
систем), который собрал все лучшие практики в мире UNIX и позволил легко переносить готовый софт между совместимыми ОС.

### **Краткая история Linux**

На базе всего наследия UNIX-систем на свет появляется Linux. Первоначально это студенческий проект Линуса Торвальдса. На первых этапах разработки
использовалась учебная ОС Minix профессора Эндрю Таненбаума, далее её компоненты были заменены на новые. Linux - разработан в 1991.

С точки зрения принципов построения ПО Linux наследует многие принципы UNIX-систем, часто имеет одинаковые названия программ и параметров. Это
позволило быстро переходить на использование Linux для специалистов по UNIX-системам.

Однако, изначально Linux представлял собой только ядро и для полноценной системы не хватало важных компонентов: компиляторов, оболочки, утилит. В
качестве донора этих компонентов для Linux выступает проект GNU.

### **Проект GNU**

Проект GNU был запущен как антипод коммерческим закрытым системам UNIX. То есть стояла задача повторить все лучшие черты UNIX-систем, убрав лицензионные
ограничения. В основу были положены принципы открытости исходного кода и свободного распространения ПО. Именно этот проект дал импульс развитию
движения свободного ПО, в основе которого лежит открытый исходный код и либеральная лицензия на использование.

В проекте GNU было одного слабое место – ядро. Именно здесь как нельзя кстати приходит Linux. В результате получаем систему GNU/Linux, однако для краткости
систему принято называть просто “Linux”. GNU/Linux: GNU - утилиты, библиотеки / Linux - ядро.

### **Применение Linux в серверной среде**

Сегодня Linux является стандартом де-факто в разряде платформ для веб-приложений. Гибкость и масштабируемость системы позволяет использовать её в
самых различных применениях: от мобильных устройств (Android) до суперкомпьютеров.

Использование Linux в серверной среде:  
- 100% - Топ-500 суперкомпьютеров.  
- 95% - самых популярных сайтов.  
- 90% - облачной инфраструктуры.

### **Что такое дистрибутив Linux**

Дистрибутив Linux – это готовая к использованию сборка всех необходимых компонентов ОС (ядро, библиотеки, оболочка, средства разработки, прикладные
программы). В зависимости от направленности дистрибутив может иметь различную комплектацию: например, настольные версии имеют графический интерфейс, а
серверные его не имеют. Так как области применения Linux очень разнообразные, существует огромный выбор дистрибутивов – более 200 Однако, не стоит
отчаиваться – в таком разнообразии нет большой проблемы. Большинство отдельных “дистрибутивов” это просто клоны одной и той же системы с различной графической
оболочкой. Если же отбросить десктопные системы и говорить только о серверных, остаётся выбор нескольких ветвей развития.

### **Классификация дистрибутивов Linux**

Разделяются дистрибутивы по комплекту поставки и принятой модели упаковки программного обеспечения.

Прежде всего важна система пакетов ПО. Пакет – это готовое к установке ПО, упакованное в архив. Система пакетов отвечает за автоматизацию установки,
удаления и конфигурации ПО. Существуют дистрибутивы без пакетных систем, но их меньшинство.

Наиболее популярные серверные дистрибутивы можно разделить на две группы:“Red Hat” и “Debian”.

### **Red Hat и Debian дистрибутивы**

**Первая группа** дистрибутивов может условно называться “Red Hat” – дистрибутивы, основанные на системе пакетов RPM (*red hat package manager*). Red hat (RPM).

**Вторая группа** это Debian – дистрибутивы, основанные на DEB-пакетах. Внутри этой группы находится система Ubuntu. Ubuntu (DEB). DEB - пакеты.

**В третью группу** можно вынести все остальные дистрибутивы — для серверного рынка это скорее экзотика и можно не заострять на них своё внимание.

Таким образом, если получить опыт работы с дистрибутивами из первых двух групп, можно совершенно спокойно чувствовать себя с Linux-системами. При этом разница
между дистрибутивами будет проявляться в командах по установке пакетов и размещению конфигурационных файлов. Также различия могут проявиться в
наличии ПО, которое поставляется в комплекте. Некоторые дистрибутивы стремятся к стабильности и редко обновляют ПО, другие же наоборот предоставляют новейшие
версии софта. Все основные принципы и архитектура Linux остаются неизменными.

### **Ubuntu. Desktop, Server, LTS и обычный релиз**

Ubuntu это серия дистрибутивов, поставляемых компанией Canonical. Прежде всего мы разделяем серверную и настольную версии. Внутри этих веток есть 2 типа
релизов: LTS (*Long Term Support* – длительная поддержка) и не-LTS.

LTS версия выходит каждые 2 года и отличается повышенной стабильностью и сроком поддержки 5 лет после выхода релиза. То есть, LTS это лучший кандидат на установку
для решения критичных задач.

Не-LTS версия выходит каждые полгода и содержит новейшие версии пакетов. В какой-то степени это экспериментальная площадка для создания следующего
LTS-дистрибутива.

Серверная система не имеет графического интерфейса и в стандартном комплекте содержит пакеты для основных сервисов (веб-сервер, SSH, почтовый сервер,
средства контейнеризации и т.д.)

Настольный вариант Ubuntu имеет полноценный графический интерфейс, установщик здесь также графический (в отличие от серверного). Но при этом на
десктопной системе также доступны все серверные компоненты.

### **Структура файловой системы**
Общая иерархия файловой системы в Linux отличается от модели Windows. Если в Windows отдельные разделы и диски принято обозначать буквами, то в Linux есть
единая иерархия директорий, которая начинается с корня (root или /).
Все остальные диски и разделы подключаются (монтируются) в эту общую систему. В корневой файловой системе существует набор стандартных директорий, каждая из
которых несёт свою функцию. Эти директории описаны в стандарте FHS (*Filesystem Hierarchy Standard*). Стандарт FHS определяет, какие по назначению файлы должны
находиться в определённых директориях. Например, исполняемые файлы должны находиться в каталоге /bin или /usr/bin, настройки в /etc и т.д.

Ниже представлены основные стандартные каталоги в Linux.

| /          | Корневой каталог, содержащий всю файловую иерархию.                                                                                                                                                                                      |
|------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| /bin       | Основные утилиты, необходимые как в однопользовательском режиме, так и при обычной работе всем пользователям (например: cat, ls, cp).                                                                                                    |
| /boot      | Загрузочные файлы (в том числе файлы загрузчика, ядро, initrd, System.map). Часто выносится на отдельный раздел.                                                                                                                         |
| /dev       | Основные файлы устройств (например, /dev/null, /dev/zero).                                                                                                                                                                               |
| /etc       | Общесистемные конфигурационные файлы (имя происходит от лат. et cetera).                                                                                                                                                                 |
| /home      | Содержит домашние каталоги пользователей, которые в свою очередь содержат персональные настройки и данные пользователя. Часто размещается на отдельном разделе.                                                                          |
| /lib       | Основные библиотеки, необходимые для работы программ из /bin и /sbin.                                                                                                                                                                    |
| /media     | Точки монтирования для сменных носителей.                                                                                                                                                                                                |
| /mnt       | Содержит временно монтируемые файловые системы.                                                                                                                                                                                          |
| /opt       | Дополнительное программное обеспечение.                                                                                                                                                                                                  |
| /proc      | Виртуальная файловая система, представляющая состояние ядра операционной системы и запущенных процессов в виде файлов.                                                                                                                   |
| /root      | Домашний каталог пользователя root.                                                                                                                                                                                                      |
| /run       | Информация о системе с момента её загрузки, в том числе данные, необходимые для работы демонов (pid-файлы, UNIX-сокеты и т.д.)                                                                                                           |
| /sbin      | Основные системные программы для администрирования и настройки системы, например, init, iptables, ifconfig.                                                                                                                              |
| /srv       | Данные для сервисов, предоставляемых системой (например, www или ftp).                                                                                                                                                                   |
| /sys       | Содержит информацию об устройствах, драйверах, а также некоторых свойствах ядра.                                                                                                                                                         |
| /tmp       | Временные файлы (см. также /var/tmp).                                                                                                                                                                                                    |
| /usr       | Вторичная иерархия для данных пользователя. Содержит большинство пользовательских приложений и утилит, используемых в многопользовательском режиме. Может быть смонтирована по сети только для чтения и быть общей для нескольких машин. |
| /usr/bin   | Дополнительные программы для всех пользователей, не являющиеся необходимыми в однопользовательском режиме.                                                                                                                               |
| /usr/lib   | Библиотеки для программ, находящихся в /usr/bin и /usr/sbin.                                                                                                                                                                             |
| /usr/local | Третичная иерархия для данных, специфичных для данного хоста. Обычно содержит такие подкаталоги, как bin, lib, share.                                                                                                                    |
| /usr/sbin  | Дополнительные системные программы (такие как демоны различных сетевых сервисов).                                                                                                                                                        |
| /var       | Изменяемые файлы, такие как файлы регистрации, временные почтовые файлы, файлы спулеров.                                                                                                                                                 |
| /var/lib   | Информация о состоянии. Постоянные данные, изменяемые программами в процессе работы (например, базы данных, метаданные пакетного менеджера и др.).                                                                                       |
| /var/log   | Различные файлы журналов (логи).                                                                                                                                                                                                         |

Важно заметить, что при установке ПО размещается сразу в нескольких каталогах:исполняемые файлы в /bin, настройки в /etc/ и т.д. Поэтому важно использовать
пакетные менеджеры для управления ПО в Linux.

### **Текстовый интерфейс и подключение по SSH**

Основной вариант управления для серверных Linux-систем – текстовый интерфейс. Именно такой вариант позволяет максимально эффективно управлять сервисами.
Текстовые команды могут составлять часть скриптов, которые автоматизируют многие действия по администрированию системы.

Еще одно важное преимущество текстового интерфейса – универсальность, то есть независимость от дистрибутива. Почти все базовые команды будут работать
одинаково в любом варианте Linux. Команды в текстовом интерфейсе вводятся через оболочку (*shell*) с использованием терминала или консоли.

Есть 2 варианта запуска терминала в Ubuntu – через меню приложений и по сочетанию клавиш **Ctrl+Alt+T**. **Ctrl Shift +** увеличить содержимое терминала.

При этом основным способом управления сервером является подключение по протоколу SSH (*Secure SHell*). Этот протокол позволяет удалённо и безопасно
подключаться к системе для управления через оболочку. Безопасность достигается за счет сквозного шифрования данных сеанса.

### **Установка пакетов в Ubuntu**

Самый простой вариант установки софта в Ubuntu это пакетный менеджер apt. Процесс установки пакетов максимально автоматизирован и требует лишь знания названия пакета.

      sudo apt update                   – обновить список пакетов из настроенных репозиториев.  
      sudo apt install mc               – установить пакет mc. Файловый медеджер Midnight Commander.  
      sudo apt install openssh-server   – установить SSH-сервер.

Команда **sudo** запускает следующую команду в режиме суперпользователя(администратора), **apt** – команда пакетного менеджера в Ubuntu, **install** – режим
установки пакета. Название пакета можно найти в Интернете или в консоли. После ввода команды обычно требуется ввести пароль от
вашего основного пользователя (на несколько минут он кэшируется и не запрашивается повторно).

---

Виртуализация в VirtualBox  
● Межплатформенный продукт.  
● Требуется поддержка аппаратной виртуализации в CPU.  
● Широкие возможности по экспериментам.

Настройка виртуальной машины  
● RAM от 2048 MB  
● Диск от 20 GB  
● Загрузка с установочного ISO

Установка гостевых дополнений VB в Ubuntu  
● sudo apt update – обновить список пакетов  
● sudo apt install perl gcc make – установить пакеты  
● Запуск установки гостевых дополнений

Сетевые режимы VirtualBox  
● Мост (bridge) – ВМ в локальной сети, прямой доступ к ВМ по IP.  
● NAT – ВМ в своей сети, доступ к машине только через проброс портов.

1. Узнаем наш IPv4: 192.168.0.104  
   Через консоль в Linux: ip a - список интерфейсов подключения к интернету.

2. Проверяем статус ssh клиента.  
   Через консоль в Linux: systemctl status ssh

   Active: active(running) - означает что работает (зеленого цвета).
   Так же указывается порт: 22 (по умолчанию).

3. Устанавливаем сетевое соединение.  
   Через консоль Windows: ssh evgeniy@192.168.0.104 Где evgeniy@ - пользователь, 192.168.0.104 - IP.

4. Подтверждаем соединение: yes.

5. Вводим пароль Linux. Можем работать с удаленным сервером.

---
[Вернуться назад](<Linux.md>)